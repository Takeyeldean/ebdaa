// ULTRA-FAST JavaScript - Optimized for Maximum Performance (function(){ 'use strict';const d=document,w=window;let mobileMenuOpen=false,performanceStart=performance.now();// Ultra-fast DOM queries with caching const $=(s)=>d.querySelector(s),$$=(s)=>d.querySelectorAll(s);const cache=new Map();// Performance monitoring function logPerformance(action,time=performance.now()){ console.log(`⚡ ${action}: ${(time-performanceStart).toFixed(2)}ms`);}// Debounced functions for performance function debounce(func,wait){ let timeout;return function executedFunction(...args){ const later=()=>{clearTimeout(timeout);func(...args)};clearTimeout(timeout);timeout=setTimeout(later,wait);};}// Throttled functions for scroll/resize function throttle(func,limit){ let inThrottle;return function(){ const args=arguments;const context=this;if(!inThrottle){ func.apply(context,args);inThrottle=true;setTimeout(()=>inThrottle=false,limit);};};}// Ultra-fast mobile menu toggle function toggleMobileMenu(){ const menu=$('#mobile-nav-menu'),icon=$('#mobile-menu-icon');if(!menu||!icon)return;mobileMenuOpen=!mobileMenuOpen;if(mobileMenuOpen){ menu.classList.add('active');icon.classList.remove('fa-bars');icon.classList.add('fa-times');}else{ menu.classList.remove('active');icon.classList.remove('fa-times');icon.classList.add('fa-bars');}logPerformance('Mobile menu toggle');}// Ultra-fast lazy loading function lazyLoadImages(){ const images=$$('img[data-src]');const imageObserver=new IntersectionObserver((entries,observer)=>{ entries.forEach(entry=>{ if(entry.isIntersecting){ const img=entry.target;img.src=img.dataset.src;img.classList.remove('lazy');img.classList.add('loaded');observer.unobserve(img);logPerformance('Image loaded');}});},{rootMargin:'50px 0px',threshold:0.01});images.forEach(img=>imageObserver.observe(img));}// Ultra-fast preloading function preloadCriticalResources(){ const criticalImages=['assets/images/logo.png','assets/images/background.jpg'];criticalImages.forEach(src=>{ const link=d.createElement('link');link.rel='preload';link.as='image';link.href=src;d.head.appendChild(link);});logPerformance('Critical resources preloaded');}// Ultra-fast animations optimization function optimizeAnimations(){ const prefersReducedMotion=w.matchMedia('(prefers-reduced-motion: reduce)').matches;if(prefersReducedMotion){ d.documentElement.style.setProperty('--animation-duration','0.01ms');d.documentElement.style.setProperty('--animation-iteration-count','1');}logPerformance('Animations optimized');}// Ultra-fast performance monitoring function setupPerformanceMonitoring(){ if('performance' in w){ w.addEventListener('load',()=>{ const perfData=w.performance.timing;const loadTime=perfData.loadEventEnd-perfData.navigationStart;if(loadTime>2000){ console.warn('⚡ Slow page load:',loadTime+'ms');}logPerformance('Page load complete',perfData.loadEventEnd);});}}// Ultra-fast dark mode function initializeDarkMode(){ const theme=localStorage.getItem('theme')||'light';const userRole=d.body.querySelector('[data-user-role="student"]')?'student':'admin';const currentPage=w.location.pathname.includes('profile')?'profile':w.location.pathname.includes('questions')?'questions':'other';if(userRole==='student'&&(currentPage==='profile'||currentPage==='questions')){ d.documentElement.setAttribute('data-theme',theme);d.documentElement.setAttribute('data-user-role',userRole);d.documentElement.setAttribute('data-page',currentPage);const toggleButtons=$$('.dark-mode-toggle');toggleButtons.forEach(button=>{ button.addEventListener('click',()=>{ const newTheme=theme==='light'?'dark':'light';d.documentElement.setAttribute('data-theme',newTheme);localStorage.setItem('theme',newTheme);const icons=$$('.dark-mode-toggle i');icons.forEach(icon=>{ icon.className=newTheme==='dark'?'fas fa-sun':'fas fa-moon';});logPerformance('Dark mode toggled');});});}else{ const toggleButtons=$$('.dark-mode-toggle');toggleButtons.forEach(button=>button.style.display='none');}logPerformance('Dark mode initialized');}// Ultra-fast charts optimization function optimizeCharts(){ const chartCanvases=$$('canvas');chartCanvases.forEach(canvas=>{ canvas.style.willChange='transform';canvas.style.transform='translateZ(0)';});logPerformance('Charts optimized');}// Ultra-fast event listeners function setupEventListeners(){ d.addEventListener('click',e=>{ if(e.target.closest('.mobile-menu-btn'))toggleMobileMenu();if(e.target.closest('.dark-mode-toggle')){ const theme=d.documentElement.getAttribute('data-theme');const newTheme=theme==='light'?'dark':'light';d.documentElement.setAttribute('data-theme',newTheme);localStorage.setItem('theme',newTheme);}});d.addEventListener('click',e=>{ const mobileMenu=$('#mobile-nav-menu');const menuBtn=$('.mobile-menu-btn');if(mobileMenu&&menuBtn&&!mobileMenu.contains(e.target)&&!menuBtn.contains(e.target)){ mobileMenuOpen=false;mobileMenu.classList.remove('active');const icon=$('#mobile-menu-icon');if(icon){ icon.classList.remove('fa-times');icon.classList.add('fa-bars');}}});w.addEventListener('resize',debounce(()=>{ if(w.innerWidth>768&&mobileMenuOpen){ mobileMenuOpen=false;const menu=$('#mobile-nav-menu'),icon=$('#mobile-menu-icon');if(menu&&icon){ menu.classList.remove('active');icon.classList.remove('fa-times');icon.classList.add('fa-bars');}}},250));w.addEventListener('scroll',throttle(()=>{ const scrolled=w.pageYOffset;if(scrolled>100){ d.body.classList.add('scrolled');}else{ d.body.classList.remove('scrolled');}},16));logPerformance('Event listeners setup');}// Ultra-fast service worker function initializeServiceWorker(){ if('serviceWorker' in navigator){ w.addEventListener('load',()=>{ navigator.serviceWorker.register('/sw.js').then(registration=>{ console.log('⚡ SW registered:',registration);logPerformance('Service worker registered');}).catch(error=>console.log('SW registration failed:',error));});}}// Ultra-fast intersection observer function setupIntersectionObserver(){ const observer=new IntersectionObserver((entries)=>{ entries.forEach(entry=>{ if(entry.isIntersecting){ entry.target.classList.add('visible');observer.unobserve(entry.target);logPerformance('Element visible');}});},{threshold:0.1});$$('.card,.question-card').forEach(el=>observer.observe(el));logPerformance('Intersection observer setup');}// Ultra-fast form optimization function optimizeForms(){ const forms=$$('form');forms.forEach(form=>{ form.addEventListener('submit',e=>{ const submitBtn=form.querySelector('button[type="submit"]');if(submitBtn){ submitBtn.disabled=true;submitBtn.textContent='جاري المعالجة...';setTimeout(()=>{ submitBtn.disabled=false;submitBtn.textContent='إرسال';},2000);}logPerformance('Form submitted');});});logPerformance('Forms optimized');}// Ultra-fast initialization function initializeApp(){ preloadCriticalResources();optimizeAnimations();setupPerformanceMonitoring();initializeDarkMode();optimizeCharts();setupEventListeners();initializeServiceWorker();setupIntersectionObserver();optimizeForms();lazyLoadImages();logPerformance('App initialized');}// Ultra-fast startup if(d.readyState==='loading'){ d.addEventListener('DOMContentLoaded',initializeApp);}else{ initializeApp();}// Ultra-fast cleanup w.addEventListener('beforeunload',()=>{ cache.clear();logPerformance('App cleanup');});})();